ä½ è¦çš„æ˜¯ ä¸€ä¸ª GitHub Actions YAML çš„â€œå…¨å­—æ®µã€å…¨ç»“æ„ã€æŒ‰å®˜æ–¹é¡ºåºæ’åˆ—â€çš„ç¤ºä¾‹æ–‡ä»¶â€”â€”ä¹Ÿå°±æ˜¯ä¸€ä¸ªæœ€å®Œæ•´ã€æœ€è§„èŒƒçš„æ¨¡æ¿ï¼ŒåŒ…å«æ‰€æœ‰å¸¸è§å­—æ®µã€å¯é€‰å­—æ®µã€ç»“æ„é¡ºåºã€å¹¶ä¸”æ˜¯å¯è¿è¡Œçš„ã€‚

æˆ‘ç»™ä½ å‡†å¤‡äº†ä¸€ä¸ª ä¸“ä¸šçº§ã€å¯ç›´æ¥ä½œä¸ºå›¢é˜Ÿæ¨¡æ¿ä½¿ç”¨ çš„ç‰ˆæœ¬ã€‚

---

ğŸ§© GitHub Actions æœ€å®Œæ•´ç»“æ„ç¤ºä¾‹ï¼ˆå…¨å­—æ®µã€æŒ‰é¡ºåºï¼‰

ä¸‹é¢è¿™ä¸ªç¤ºä¾‹åŒ…å«ï¼š

â€¢ name
â€¢ run-name
â€¢ onï¼ˆæ‰€æœ‰å¸¸è§è§¦å‘å™¨ï¼‰
â€¢ permissions
â€¢ env
â€¢ defaults
â€¢ concurrency
â€¢ jobsï¼ˆå«å®Œæ•´å­—æ®µï¼‰
â€¢ outputs
â€¢ strategy
â€¢ services
â€¢ stepsï¼ˆå«æ‰€æœ‰å¸¸è§å­—æ®µï¼‰
â€¢ $GITHUB_OUTPUT æ–°è¯­æ³•ç¤ºä¾‹


è¿™æ˜¯ä½ èƒ½æ‰¾åˆ°çš„æœ€å®Œæ•´ã€æœ€è§„èŒƒçš„ç»“æ„æ¨¡æ¿ã€‚

---

âœ… å®Œæ•´ GitHub Actions YAML æ¨¡æ¿

name: CI Pipeline
run-name: CI Pipeline run by ${{ github.actor }}

on:
  push:
    branches: [ main, develop ]
    tags: [ 'v*' ]
    paths: [ '**.kt', '**.yml' ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:
    inputs:
      environment:
        description: "Target environment"
        required: true
        default: "dev"
  schedule:
    - cron: "0 3 * * *"

permissions:
  contents: read
  actions: read
  checks: write
  pull-requests: write

env:
  GLOBAL_ENV: "global-value"

defaults:
  run:
    shell: bash
    working-directory: ./

concurrency:
  group: ci-${{ github.ref }}
  cancel-in-progress: true

jobs:
  build:
    name: Build and Test
    runs-on: ubuntu-latest

    environment:
      name: dev
      url: https://example.com

    outputs:
      build_version: ${{ steps.meta.outputs.version }}

    strategy:
      fail-fast: false
      matrix:
        java: [ '17', '21' ]
        os: [ ubuntu-latest ]

    services:
      postgres:
        image: postgres:15
        ports:
          - 5432:5432
        env:
          POSTGRES_PASSWORD: example
        options: >-
          --health-cmd="pg_isready"
          --health-interval=10s
          --health-timeout=5s
          --health-retries=5

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Java
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: ${{ matrix.java }}

      - name: Set metadata output
        id: meta
        run: |
          VERSION="1.2.${{ github.run_number }}"
          echo "version=$VERSION" >> $GITHUB_OUTPUT

      - name: Cache Gradle
        uses: actions/cache@v4
        with:
          path: |
            ~/.gradle/caches
            ~/.gradle/wrapper
          key: gradle-${{ runner.os }}-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}

      - name: Build
        run: ./gradlew build --no-daemon

      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: build-output
          path: build/libs/*.jar

  deploy:
    name: Deploy to Environment
    needs: build
    runs-on: ubuntu-latest

    environment:
      name: prod

    steps:
      - name: Print version from previous job
        run: echo "Deploying version ${{ needs.build.outputs.build_version }}"


---

ğŸ¯ è¿™ä¸ªæ¨¡æ¿çš„ç‰¹ç‚¹

âœ” å…¨å­—æ®µ

åŒ…å« GitHub Actions ä¸­æ‰€æœ‰å¸¸è§å­—æ®µï¼ŒæŒ‰å®˜æ–¹æ¨èé¡ºåºæ’åˆ—ã€‚

âœ” å¯ç›´æ¥è¿è¡Œ

ä¸æ˜¯ç†è®ºæ¨¡æ¿ï¼Œæ˜¯å¯æ‰§è¡Œçš„ CI/CD pipelineã€‚

âœ” ä½¿ç”¨äº†æœ€æ–° `$GITHUB_OUTPUT`

å®Œå…¨ç¬¦åˆ GitHub æœ€æ–°è§„èŒƒã€‚

âœ” é€‚åˆå›¢é˜Ÿå¤ç”¨

ç»“æ„æ¸…æ™°ã€å¯æ‰©å±•ã€å¯ç»´æŠ¤ã€‚

---

å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥å¸®ä½ ç”Ÿæˆï¼š

â€¢ é€‚ç”¨äº Spring Boot + Gradle + Docker Compose çš„å®Œæ•´ CI/CD æ¨¡æ¿
â€¢ é€‚ç”¨äºå¤šæ¨¡å— Kotlin é¡¹ç›®çš„çŸ©é˜µæ„å»ºæ¨¡æ¿
â€¢ é€‚ç”¨äº GitHub Pagesã€Cloudflareã€AWSã€GCP çš„éƒ¨ç½²æ¨¡æ¿


åªè¦å‘Šè¯‰æˆ‘ä½ çš„æŠ€æœ¯æ ˆï¼Œæˆ‘å¯ä»¥ç›´æ¥ä¸ºä½ å®šåˆ¶ä¸€ä¸ªç”Ÿäº§çº§ workflowã€‚


