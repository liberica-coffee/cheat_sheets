TypeScript å‘½ä»¤å¤‡å¿˜å½•

ğŸ“¦ å®‰è£…ä¸åˆå§‹åŒ–

å…¨å±€å®‰è£…

```bash
# å…¨å±€å®‰è£… TypeScript
npm install -g typescript

# æ£€æŸ¥ç‰ˆæœ¬
tsc --version
tsserver --version

# å…¨å±€å®‰è£… ts-nodeï¼ˆç›´æ¥è¿è¡Œ TSï¼‰
npm install -g ts-node
npm install -g ts-node-dev  # çƒ­é‡è½½
```

é¡¹ç›®åˆå§‹åŒ–

```bash
# åˆå§‹åŒ–é¡¹ç›®ï¼ˆç”Ÿæˆ package.jsonï¼‰
npm init -y

# å®‰è£… TypeScript ä¸ºå¼€å‘ä¾èµ–
npm install --save-dev typescript

# ç”Ÿæˆ tsconfig.json
npx tsc --init

# å®‰è£…ç±»å‹å®šä¹‰
npm install --save-dev @types/node
npm install --save-dev @types/react  # React é¡¹ç›®
npm install --save-dev @types/jest   # Jest æµ‹è¯•

# å®‰è£… ts-node ç”¨äºå¼€å‘
npm install --save-dev ts-node
npm install --save-dev ts-node-dev
```

âš™ï¸ ç¼–è¯‘å‘½ä»¤

åŸºæœ¬ç¼–è¯‘

```bash
# ç¼–è¯‘å•ä¸ªæ–‡ä»¶
tsc app.ts

# ç¼–è¯‘å¹¶è¿è¡Œ
tsc app.ts && node app.js

# ä½¿ç”¨ ts-node ç›´æ¥è¿è¡Œ
ts-node app.ts

# å¸¦ç›‘è§†æ¨¡å¼
tsc app.ts --watch
tsc app.ts -w

# ç¼–è¯‘æ•´ä¸ªé¡¹ç›®
tsc

# ç›‘è§†æ¨¡å¼ç¼–è¯‘æ•´ä¸ªé¡¹ç›®
tsc --watch
tsc -w

# å¢é‡ç¼–è¯‘ï¼ˆæ›´å¿«ï¼‰
tsc --incremental
tsc --watch --incremental
```

ç¼–è¯‘é€‰é¡¹

```bash
# æŒ‡å®šè¾“å‡ºç›®å½•
tsc --outDir ./dist

# æŒ‡å®šç›®æ ‡ JavaScript ç‰ˆæœ¬
tsc --target ES2020
tsc --target ES2015
tsc --target ES6

# æŒ‡å®šæ¨¡å—ç³»ç»Ÿ
tsc --module CommonJS
tsc --module ES2020
tsc --module ES6

# ç”Ÿæˆæºæ˜ å°„ï¼ˆsource mapsï¼‰
tsc --sourceMap

# ç”Ÿæˆå£°æ˜æ–‡ä»¶ï¼ˆ.d.tsï¼‰
tsc --declaration
tsc --declaration --declarationMap

# ä¸¥æ ¼æ¨¡å¼
tsc --strict
tsc --noImplicitAny --strictNullChecks --strictFunctionTypes

# å¿½ç•¥é”™è¯¯ç¼–è¯‘
tsc --noEmitOnError false

# åªç¼–è¯‘ä¸è¾“å‡ºæ–‡ä»¶
tsc --noEmit

# æ˜¾ç¤ºè¯¦ç»†ç¼–è¯‘ä¿¡æ¯
tsc --listFiles
tsc --diagnostics
tsc --extendedDiagnostics

# æ¸…ç†è¾“å‡º
tsc --clean
```

ğŸ¯ é…ç½®æ–‡ä»¶ç›¸å…³

tsconfig.json å¸¸ç”¨é…ç½®

```json
{
  "compilerOptions": {
    // åŸºç¡€é€‰é¡¹
    "target": "ES2020",
    "module": "CommonJS",
    "lib": ["ES2020", "DOM"],
    "outDir": "./dist",
    "rootDir": "./src",
    
    // ä¸¥æ ¼æ¨¡å¼é€‰é¡¹
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    
    // æ¨¡å—è§£æ
    "moduleResolution": "node",
    "baseUrl": "./",
    "paths": {
      "@/*": ["src/*"],
      "@components/*": ["src/components/*"]
    },
    
    // è¾“å‡ºæ§åˆ¶
    "sourceMap": true,
    "declaration": true,
    
    // å®éªŒæ€§åŠŸèƒ½
    "experimentalDecorators": true,
    "emitDecoratorMetadata": true,
    
    // å…¶ä»–
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist", "**/*.test.ts"]
}
```

ä½¿ç”¨ä¸åŒé…ç½®æ–‡ä»¶

```bash
# æŒ‡å®šé…ç½®æ–‡ä»¶
tsc --project tsconfig.json
tsc -p tsconfig.json

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶
tsc -p tsconfig.prod.json
tsc -p tsconfig.dev.json

# æ‰©å±•é…ç½®æ–‡ä»¶
tsc -p tsconfig.base.json
```

ğŸš€ å¼€å‘ä¸è°ƒè¯•

å¼€å‘æœåŠ¡å™¨

```bash
# ä½¿ç”¨ ts-node-devï¼ˆçƒ­é‡è½½ï¼‰
ts-node-dev --respawn --transpile-only src/index.ts

# å¸¦è°ƒè¯•
ts-node-dev --inspect --respawn src/index.ts

# ä½¿ç”¨ nodemon + ts-node
nodemon --exec ts-node src/index.ts

# ä½¿ç”¨ webpack-dev-server
npm run dev  # é€šå¸¸é…ç½®åœ¨ package.json ä¸­
```

è°ƒè¯•å‘½ä»¤

```bash
# Node.js è°ƒè¯•
node --inspect dist/app.js

# ç”¨ ts-node è°ƒè¯•
ts-node --inspect src/app.ts

# Chrome å¼€å‘è€…å·¥å…·è°ƒè¯•
# æ‰“å¼€ chrome://inspect

# VS Code è°ƒè¯•é…ç½®ï¼ˆ.vscode/launch.jsonï¼‰
{
  "type": "node",
  "request": "launch",
  "name": "Debug TypeScript",
  "runtimeArgs": ["-r", "ts-node/register"],
  "args": ["${workspaceFolder}/src/index.ts"]
}
```

ğŸ§ª æµ‹è¯•ç›¸å…³

æµ‹è¯•æ¡†æ¶

```bash
# Jest
npm install --save-dev jest ts-jest @types/jest
npx ts-jest config:init

# è¿è¡Œ Jest æµ‹è¯•
npm test
jest
jest --watch
jest --coverage

# Mocha + Chai
npm install --save-dev mocha chai @types/mocha @types/chai ts-node
mocha --require ts-node/register 'test/**/*.test.ts'

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
jest src/components/Button.test.ts
mocha test/user.test.ts
```

ğŸ“ é¡¹ç›®ç»“æ„å‘½ä»¤

åˆ›å»ºé¡¹ç›®ç»“æ„

```bash
# åˆ›å»ºæ ‡å‡† TypeScript é¡¹ç›®ç»“æ„
mkdir my-ts-project
cd my-ts-project
npm init -y
npm install typescript --save-dev
npx tsc --init

# åˆ›å»ºç›®å½•ç»“æ„
mkdir src
mkdir dist
mkdir test
mkdir @types  # è‡ªå®šä¹‰ç±»å‹å®šä¹‰

# åˆ›å»ºå…¥å£æ–‡ä»¶
echo 'console.log("Hello TypeScript!");' > src/index.ts

# åˆ›å»ºæµ‹è¯•æ–‡ä»¶
echo 'import { expect } from "chai";' > test/index.test.ts
```

ğŸ”§ æ„å»ºä¸æ‰“åŒ…

Webpack é…ç½®

```bash
# å®‰è£… webpack
npm install --save-dev webpack webpack-cli
npm install --save-dev ts-loader

# è¿è¡Œ webpack
npx webpack --config webpack.config.js

# å¼€å‘æ¨¡å¼
npx webpack --mode development

# ç”Ÿäº§æ¨¡å¼
npx webpack --mode production
```

Rollup é…ç½®

```bash
# å®‰è£… rollup
npm install --save-dev rollup @rollup/plugin-typescript

# è¿è¡Œ rollup
npx rollup -c
```

æ„å»ºè„šæœ¬ç¤ºä¾‹ï¼ˆpackage.jsonï¼‰

```json
{
  "scripts": {
    "build": "tsc",
    "build:watch": "tsc --watch",
    "build:prod": "tsc --project tsconfig.prod.json",
    "start": "node dist/index.js",
    "start:dev": "ts-node-dev --respawn src/index.ts",
    "dev": "nodemon --exec ts-node src/index.ts",
    "test": "jest",
    "test:watch": "jest --watch",
    "lint": "eslint src/**/*.ts",
    "format": "prettier --write src/**/*.ts"
  }
}
```

ğŸ§¹ ä»£ç è´¨é‡å·¥å…·

ESLint

```bash
# å®‰è£…
npm install --save-dev eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin

# åˆå§‹åŒ–é…ç½®
npx eslint --init

# è¿è¡Œæ£€æŸ¥
npx eslint src/**/*.ts

# è‡ªåŠ¨ä¿®å¤
npx eslint src/**/*.ts --fix
```

Prettier

```bash
# å®‰è£…
npm install --save-dev prettier

# æ ¼å¼åŒ–ä»£ç 
npx prettier --write src/**/*.ts

# æ£€æŸ¥æ ¼å¼
npx prettier --check src/**/*.ts
```

ç±»å‹æ£€æŸ¥

```bash
# åªåšç±»å‹æ£€æŸ¥ï¼Œä¸ç¼–è¯‘
tsc --noEmit

# ç±»å‹æ£€æŸ¥å¹¶æ˜¾ç¤ºæ‰€æœ‰é”™è¯¯
tsc --noEmit --strict

# æ£€æŸ¥ç‰¹å®šæ–‡ä»¶
tsc --noEmit src/utils/*.ts
```

ğŸ“š ç±»å‹ç®¡ç†

ç±»å‹å£°æ˜

```bash
# å®‰è£… DefinitelyTyped ç±»å‹åŒ…
npm install --save-dev @types/lodash
npm install --save-dev @types/express
npm install --save-dev @types/react @types/react-dom

# æŸ¥çœ‹å·²å®‰è£…çš„ç±»å‹åŒ…
npm list @types

# åˆ›å»ºè‡ªå®šä¹‰ç±»å‹å£°æ˜æ–‡ä»¶
# åœ¨ src/types æˆ– @types ç›®å½•ä¸‹åˆ›å»º .d.ts æ–‡ä»¶
```

ä¸‰æ–œçº¿æŒ‡ä»¤

```typescript
/// <reference types="node" />
/// <reference path="./my-types.d.ts" />
/// <reference lib="es2015" />
```

ğŸ” è¯Šæ–­ä¸æ€§èƒ½

æ€§èƒ½åˆ†æ

```bash
# æ˜¾ç¤ºç¼–è¯‘æ—¶é—´
tsc --diagnostics

# è¯¦ç»†è¯Šæ–­ä¿¡æ¯
tsc --extendedDiagnostics

# åˆ—å‡ºæ‰€æœ‰ç¼–è¯‘æ–‡ä»¶
tsc --listFiles

# æ˜¾ç¤ºä½¿ç”¨çš„ç¼–è¯‘å™¨é€‰é¡¹
tsc --showConfig
```

ç¼“å­˜ç®¡ç†

```bash
# å¯ç”¨æ„å»ºç¼“å­˜ï¼ˆTypeScript 3.4+ï¼‰
tsc --incremental

# æŒ‡å®šç¼“å­˜ç›®å½•
tsc --incremental --tsBuildInfoFile .tsbuildinfo

# æ¸…ç†ç¼“å­˜
tsc --clean
rm -rf .tsbuildinfo
rm -rf dist
```

ğŸ³ Docker é›†æˆ

Dockerfile ç¤ºä¾‹

```dockerfile
# å¤šé˜¶æ®µæ„å»º
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
COPY tsconfig.json ./
RUN npm ci
COPY src ./src
RUN npm run build

FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY --from=builder /app/dist ./dist
EXPOSE 3000
CMD ["node", "dist/index.js"]
```

ğŸš¨ å¸¸è§é—®é¢˜è§£å†³

é”™è¯¯å¤„ç†

```bash
# æ— æ³•æ‰¾åˆ°æ¨¡å—
# è§£å†³æ–¹æ¡ˆï¼šå®‰è£…ç±»å‹å®šä¹‰æˆ–åˆ›å»ºå£°æ˜æ–‡ä»¶

# ç±»å‹é”™è¯¯
tsc --noEmit  # æŸ¥çœ‹æ‰€æœ‰ç±»å‹é”™è¯¯

# ç¼–è¯‘ç¼“æ…¢
tsc --incremental  # å¯ç”¨å¢é‡ç¼–è¯‘
tsc --watch --preserveWatchOutput  # ä¿æŒç›‘è§†è¾“å‡º

# å†…å­˜ä¸è¶³
# å¢åŠ å†…å­˜é™åˆ¶
export NODE_OPTIONS="--max-old-space-size=4096"
```

ç¼“å­˜æ¸…ç†

```bash
# æ¸…ç†æ‰€æœ‰ç¼“å­˜
rm -rf node_modules/.cache
rm -rf .tsbuildinfo
rm -rf dist

# é‡æ–°å®‰è£…
npm cache clean --force
npm install
```

ğŸ“ å¸¸ç”¨å¿«æ·é”®å’ŒæŠ€å·§

VS Code å¿«æ·é”®

```
Ctrl + Shift + B: æ„å»ºä»»åŠ¡
F12 / Ctrl + Click: è½¬åˆ°å®šä¹‰
Alt + F12: æŸ¥çœ‹å®šä¹‰
F2: é‡å‘½åç¬¦å·
Ctrl + . : å¿«é€Ÿä¿®å¤
Shift + F12: æŸ¥çœ‹å¼•ç”¨
Ctrl + Shift + O: è½¬åˆ°ç¬¦å·
Ctrl + T: è½¬åˆ°å·¥ä½œåŒºç¬¦å·
```

å‘½ä»¤è¡ŒæŠ€å·§

```bash
# ç¼–è¯‘å¹¶è¿è¡Œ
tsc && node dist/app.js

# ç®¡é“æ“ä½œ
tsc --noEmit 2>&1 | grep "error TS"

# æ‰¹é‡æ“ä½œ
find src -name "*.ts" -exec tsc {} \;

# æ€§èƒ½æµ‹è¯•
time tsc
```

ğŸ¯ TypeScript ç‰ˆæœ¬ç‰¹æ€§å¿«é€Ÿå‚è€ƒ

ç‰ˆæœ¬æ£€æŸ¥

```bash
# æŸ¥çœ‹å½“å‰ç‰ˆæœ¬ç‰¹æ€§
tsc --version
# æˆ–æŸ¥çœ‹ node_modules/typescript/package.json

# è®¾ç½®ç‰¹å®šç‰ˆæœ¬
npm install typescript@4.9 --save-dev
```

å„ç‰ˆæœ¬é‡è¦ç‰¹æ€§

```
TypeScript 5.0: è£…é¥°å™¨ã€const ç±»å‹å‚æ•°
TypeScript 4.9: satisfies è¿ç®—ç¬¦ã€è®¿é—®å™¨è‡ªåŠ¨è¡¥å…¨
TypeScript 4.8: æ”¹è¿›çš„äº¤å‰ç±»å‹ã€æ¨¡æ¿å­—ç¬¦ä¸²æ¨æ–­
TypeScript 4.7: Node.js ES Modules æ”¯æŒ
TypeScript 4.5: Awaited ç±»å‹ã€å¯¼å…¥åç§°ä¿®é¥°ç¬¦
TypeScript 4.0: å¯å˜å…ƒç»„ç±»å‹ã€æ ‡è®°å…ƒç»„å…ƒç´ 
```

ğŸ“Š æ€§èƒ½ä¼˜åŒ–å‘½ä»¤

```bash
# ä½¿ç”¨é¡¹ç›®å¼•ç”¨ï¼ˆå¤§å‹é¡¹ç›®ï¼‰
tsc --build

# å¹¶è¡Œç¼–è¯‘
tsc --build --verbose

# è·³è¿‡ç±»å‹æ£€æŸ¥
tsc --noEmit --skipLibCheck

# è·³è¿‡å£°æ˜æ–‡ä»¶æ£€æŸ¥
tsc --noEmit --skipDefaultLibCheck

# ä½¿ç”¨ç¼–è¯‘å™¨ API è¿›è¡Œè‡ªå®šä¹‰æ„å»º
# åˆ›å»º build.ts ä½¿ç”¨ typescript æ¨¡å—
```

ğŸ”„ è¿ç§»å‘½ä»¤

ä» JavaScript è¿ç§»

```bash
# é‡å‘½åæ–‡ä»¶
find . -name "*.js" -exec sh -c 'mv "$1" "${1%.js}.ts"' _ {} \;

# åˆå§‹åŒ– TypeScript é…ç½®
npx tsc --init --allowJs --checkJs

# é€æ­¥è¿ç§»
tsc --allowJs --checkJs --noEmit
```

---

è¿™ä¸ªå¤‡å¿˜å½•æ¶µç›–äº† TypeScript å¼€å‘ä¸­çš„å¸¸ç”¨å‘½ä»¤å’ŒæŠ€å·§ï¼Œå¯ä»¥æ ¹æ®éœ€è¦éšæ—¶æŸ¥é˜…ã€‚å»ºè®®å°†å¸¸ç”¨çš„å‘½ä»¤æ·»åŠ åˆ°é¡¹ç›®çš„ package.json scripts ä¸­ï¼Œä»¥æé«˜å¼€å‘æ•ˆç‡ã€‚