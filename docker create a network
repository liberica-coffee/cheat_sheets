å½“ç„¶å¯ä»¥åœ¨æœ¬åœ° Docker é‡Œå»ºç«‹ä¸€ä¸ªâ€œè™šæ‹Ÿå†…ç½‘â€ï¼Œè®© å‰ç«¯ã€APIã€DB éƒ½åŠ å…¥åŒä¸€ä¸ªç½‘ç»œï¼Œç„¶åå®ƒä»¬å°±èƒ½äº’ç›¸ç”¨ æœåŠ¡å é€šä¿¡ï¼Œè€Œä¸æ˜¯ localhostã€‚
è¿™æ­£æ˜¯ä½ ç°åœ¨è¿™ç§å¤šå‰ç«¯ã€å¤šå…¥å£ã€å¤š APIã€å¤š DB æ¶æ„æœ€éœ€è¦çš„åŸºç¡€è®¾æ–½ã€‚

ä¸‹é¢æˆ‘ç»™ä½ ä¸€ä¸ª æœ€æ¸…æ™°ã€æœ€ç¨³ã€æœ€å®¹æ˜“ç†è§£ çš„æ–¹æ³•ã€‚

---

ğŸ§­ ä¸€å¥è¯æ€»ç»“

åœ¨ docker-compose.yml é‡Œå£°æ˜ä¸€ä¸ªç½‘ç»œï¼Œç„¶åè®©æ‰€æœ‰æœåŠ¡åŠ å…¥è¿™ä¸ªç½‘ç»œã€‚
Docker ä¼šè‡ªåŠ¨ç»™æ¯ä¸ªæœåŠ¡åˆ†é… DNS åç§°ï¼ˆservice nameï¼‰ï¼Œå®ƒä»¬å°±èƒ½äº’ç›¸è®¿é—®ã€‚

---

ğŸ§© Step 1ï¼šåœ¨ docker-compose.yml é‡Œå£°æ˜ä¸€ä¸ªç½‘ç»œ

networks:
  backend-net:


è¿™å°±åˆ›å»ºäº†ä¸€ä¸ªå« backend-net çš„è™šæ‹Ÿç½‘ç»œã€‚

---

ğŸ§© Step 2ï¼šè®©å‰ç«¯ã€APIã€DB åŠ å…¥è¿™ä¸ªç½‘ç»œ

ç¤ºä¾‹ï¼š

services:
  frontend:
    build: ./frontend
    networks:
      - backend-net

  api:
    build: ./api
    networks:
      - backend-net

  db:
    image: postgres:16
    networks:
      - backend-net

networks:
  backend-net:


åªè¦è¿™æ ·å†™ï¼Œä¸‰ä¸ªå®¹å™¨å°±è‡ªåŠ¨åŠ å…¥åŒä¸€ä¸ªç½‘ç»œã€‚

---

ğŸ§© Step 3ï¼šå®¹å™¨ä¹‹é—´ç”¨â€œæœåŠ¡åâ€äº’ç›¸è®¿é—®ï¼ˆæœ€å…³é”®ï¼‰

åŠ å…¥åŒä¸€ä¸ªç½‘ç»œåï¼š

æœåŠ¡å	å®¹å™¨å†…éƒ¨è®¿é—®æ–¹å¼	
frontend	http://frontend:80	
api	http://api:8080	
db	postgresql://db:5432	


ä¾‹å¦‚ï¼š

API è¿æ¥ DBï¼ˆSpring Bootï¼‰

SPRING_DATASOURCE_URL=jdbc:postgresql://db:5432/app


å‰ç«¯è®¿é—® APIï¼ˆTypeScriptï¼‰

API_BASE_URL=http://api:8080/api


ä¸éœ€è¦ localhost
ä¸éœ€è¦ IP
ä¸éœ€è¦ç«¯å£æ˜ å°„
Docker ä¼šè‡ªåŠ¨åš DNS è§£æã€‚

---

ğŸ§© Step 4ï¼šå®Œæ•´å¯è¿è¡Œç¤ºä¾‹ï¼ˆä½ å¯ä»¥ç›´æ¥å¤åˆ¶ï¼‰

version: "3.9"

services:
  frontend:
    build: ./frontend
    container_name: frontend
    networks:
      - backend-net

  api:
    build: ./api
    container_name: api
    environment:
      - SPRING_DATASOURCE_URL=jdbc:postgresql://db:5432/app
      - SPRING_DATASOURCE_USERNAME=app
      - SPRING_DATASOURCE_PASSWORD=app_pw
    depends_on:
      - db
    networks:
      - backend-net

  db:
    image: postgres:16
    container_name: db
    environment:
      - POSTGRES_DB=app
      - POSTGRES_USER=app
      - POSTGRES_PASSWORD=app_pw
    networks:
      - backend-net

networks:
  backend-net:


å¯åŠ¨ï¼š

docker compose up --build


---

ğŸ§ª Step 5ï¼šéªŒè¯ç½‘ç»œæ˜¯å¦æˆåŠŸ

è¿›å…¥ä»»æ„å®¹å™¨ï¼š

docker exec -it frontend bash


ping APIï¼š

ping api


ping DBï¼š

ping db


å¦‚æœèƒ½ ping é€š â†’ ç½‘ç»œ OKã€‚

---

ğŸ§­ ä½ ç°åœ¨çš„å¤šå‰ç«¯ã€å¤šå…¥å£ã€å¤š APIã€å¤š DB æ¶æ„åº”è¯¥è¿™æ ·è¿

ä¾‹å¦‚ï¼š

æ¨¡å—	è®¿é—® API	è®¿é—® DB	
frontend-a	http://api-a:8080/api	â€”	
frontend-b	http://api-b:8080/api	â€”	
api-a	â€”	jdbc:postgresql://db-a:5432/app_a	
api-b	â€”	jdbc:postgresql://db-b:5432/app_b	


æ‰€æœ‰æœåŠ¡éƒ½åŠ å…¥åŒä¸€ä¸ªç½‘ç»œï¼š

networks:
  - backend-net


---

ğŸ¯ æœ€ç»ˆä½ ä¼šå¾—åˆ°ï¼š

â€¢ æœ¬åœ° Docker å†…éƒ¨çš„â€œè™šæ‹Ÿå†…ç½‘â€
â€¢ æ‰€æœ‰å‰ç«¯ã€APIã€DB éƒ½èƒ½äº’ç›¸è®¿é—®
â€¢ ä¸å†ä½¿ç”¨ localhost
â€¢ ä¸å†ä¾èµ–æœ¬æœºç«¯å£
â€¢ ä¸å†å‡ºç°â€œè®¿é—® localhost å¤±è´¥å¯¼è‡´ 302â€çš„é—®é¢˜
â€¢ å¤šå‰ç«¯ã€å¤š APIã€å¤š DB æ¶æ„å˜å¾—æ¸…æ™°ã€å¯æ§ã€å¯è°ƒè¯•


---

å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥å¸®ä½ æŠŠï¼š

â€¢ ä½ çš„ å¤šå‰ç«¯
â€¢ å¤šä¸ª API
â€¢ å¤šä¸ª DB
â€¢ å¤šä¸ª host
â€¢ å¤šä¸ª å…¥å£
â€¢ å¤šä¸ª Thymeleaf æ¨¡å—


å…¨éƒ¨æ•´ç†æˆä¸€ä¸ª å®Œæ•´å¯è¿è¡Œçš„ docker-compose æ¶æ„ï¼Œä½ åªè¦è´´å‡ºä½ ç°åœ¨çš„ï¼š

â€¢ å‰ç«¯æ¨¡å—å
â€¢ API æ¨¡å—å
â€¢ DB åç§°
â€¢ host å

