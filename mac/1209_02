å¾ˆå¥½ ğŸ‘
è¿™é‡Œç»™ä½ ä¸€ä¸ªæ‰©å±•ç‰ˆæœ¬çš„å‡½æ•°ï¼Œå¯ä»¥ä¸€æ¬¡æ€§æå–æ–‡ä»¶é‡Œ æ‰€æœ‰çš„ data class ç‰‡æ®µï¼ŒåŒ…æ‹¬å®ƒä»¬å‰é¢çš„æ³¨é‡Šå’Œæ³¨è§£ï¼š

fun extractAllDataClasses(source: String): List<String> {
    val pattern = """(?s)(?:\s*//.*\n|\s*/\*.*?\*/\s*|\s*@\w+.*\n)*\s*data\s+class.*?(?=^\s*(?:data\s+class|\Z))"""
    val regex = Regex(pattern, RegexOption.MULTILINE)
    return regex.findAll(source).map { it.value.trim() }.toList()
}


---

ğŸ” è¯´æ˜

â€¢ (?s)ï¼šè®© . å¯ä»¥è·¨è¡ŒåŒ¹é…ã€‚
â€¢ (?: ... )*ï¼šåŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªæ³¨é‡Šæˆ–æ³¨è§£ã€‚
â€¢ data\s+classï¼šå®šä½åˆ° data classã€‚
â€¢ .*?(?=^\s*(?:data\s+class|\Z))ï¼šéè´ªå©ªåŒ¹é…åˆ°ä¸‹ä¸€ä¸ª data class æˆ–æ–‡ä»¶ç»“å°¾ã€‚
â€¢ RegexOption.MULTILINEï¼šè®© ^ å’Œ $ åœ¨å¤šè¡Œæ¨¡å¼ä¸‹å·¥ä½œã€‚


---

ğŸ“Œ ä½¿ç”¨ç¤ºä¾‹

val sourceCode = """
// æ³¨é‡Š A
@Serializable
data class Person(val name: String, val age: Int)

/* æ³¨é‡Š B */
data class Book(val title: String, val author: String)

// æ™®é€šå‡½æ•°
fun main() { println("Hello") }
"""

val results = extractAllDataClasses(sourceCode)
results.forEachIndexed { index, block ->
    println("DataClass #$index:\n$block\n")
}


ğŸ‘‰ è¾“å‡ºä¼šåˆ†åˆ«æ‰“å°å‡º Person å’Œ Book çš„å®Œæ•´ç‰‡æ®µï¼ŒåŒ…æ‹¬å®ƒä»¬å‰é¢çš„æ³¨é‡Šå’Œæ³¨è§£ã€‚

---

è¿™æ ·ä½ å°±èƒ½ä¸€æ¬¡æ€§æå–æ‰€æœ‰ data classï¼Œè€Œä¸æ˜¯åªå–ç¬¬ä¸€ä¸ªã€‚

è¦ä¸è¦æˆ‘å†å¸®ä½ åŠ ä¸€ä¸ª å‚æ•°è¿‡æ»¤åŠŸèƒ½ï¼Œæ¯”å¦‚åªè¿”å›å¸¦æœ‰ç‰¹å®šæ³¨è§£ï¼ˆå¦‚ @Serializableï¼‰çš„ data classï¼Ÿ




======


å¥½çš„ ğŸ‘
è¿™é‡Œç»™ä½ ä¸€ä¸ªå¢å¼ºç‰ˆå‡½æ•°ï¼Œå¯ä»¥ä¸€æ¬¡æ€§æå–æ–‡ä»¶é‡Œæ‰€æœ‰çš„ data classï¼Œå¹¶ä¸”æ”¯æŒ æŒ‰æ³¨è§£è¿‡æ»¤ï¼š

fun extractDataClassesWithAnnotation(
    source: String,
    annotation: String? = null
): List<String> {
    // åŸºç¡€æ¨¡å¼ï¼šåŒ¹é…æ³¨é‡Šã€æ³¨è§£ã€data class åˆ°ä¸‹ä¸€ä¸ª data class æˆ–æ–‡ä»¶ç»“å°¾
    val pattern = """(?s)(?:\s*//.*\n|\s*/\*.*?\*/\s*|\s*@\w+.*\n)*\s*data\s+class.*?(?=^\s*(?:data\s+class|\Z))"""
    val regex = Regex(pattern, RegexOption.MULTILINE)

    val allMatches = regex.findAll(source).map { it.value.trim() }.toList()

    return if (annotation != null) {
        // è¿‡æ»¤åªåŒ…å«æŒ‡å®šæ³¨è§£çš„ data class
        allMatches.filter { it.contains("@$annotation") }
    } else {
        allMatches
    }
}


---

ğŸ“Œ ä½¿ç”¨ç¤ºä¾‹

val sourceCode = """
// æ³¨é‡Š A
@Serializable
data class Person(val name: String, val age: Int)

/* æ³¨é‡Š B */
data class Book(val title: String, val author: String)

@Deprecated("æ—§ç±»")
data class OldUser(val id: Int)
"""

val resultsAll = extractDataClassesWithAnnotation(sourceCode)
println("æ‰€æœ‰ data class:")
resultsAll.forEach { println(it + "\n") }

val resultsSerializable = extractDataClassesWithAnnotation(sourceCode, "Serializable")
println("å¸¦ @Serializable çš„ data class:")
resultsSerializable.forEach { println(it + "\n") }


ğŸ‘‰ è¾“å‡ºä¼šåˆ†åˆ«æ˜¾ç¤ºï¼š

â€¢ æ‰€æœ‰ data class ç‰‡æ®µ
â€¢ åªå¸¦æœ‰ @Serializable æ³¨è§£çš„ data class


---

è¿™æ ·ä½ å°±èƒ½çµæ´»æå–å¹¶è¿‡æ»¤éœ€è¦çš„ç±»ã€‚

è¦ä¸è¦æˆ‘å†å¸®ä½ åŠ ä¸€ä¸ª è¿”å›ç±»ååˆ—è¡¨ çš„åŠŸèƒ½ï¼Œè®©ä½ å¿«é€ŸçŸ¥é“æ–‡ä»¶é‡Œæœ‰å“ªäº› data class åç§°ï¼Œè€Œä¸ç”¨çœ‹å®Œæ•´ä»£ç ç‰‡æ®µï¼Ÿ


===


å¾ˆå¥½ ğŸ‘
è¿™é‡Œç»™ä½ ä¸€ä¸ªå¢å¼ºç‰ˆå‡½æ•°ï¼Œå¯ä»¥æå–æ‰€æœ‰ data class çš„å®Œæ•´ç‰‡æ®µï¼Œå¹¶ä¸”è¿”å›å®ƒä»¬çš„ ç±»ååˆ—è¡¨ï¼Œæ–¹ä¾¿å¿«é€ŸæŸ¥çœ‹æ–‡ä»¶é‡Œæœ‰å“ªäº›ç±»ï¼š

fun extractDataClassNames(source: String): List<String> {
    val regex = Regex("""\bdata\s+class\s+([A-Z]\w*)""")
    return regex.findAll(source).map { it.groupValues[1] }.toList()
}

fun extractAllDataClasses(source: String): List<String> {
    val pattern = """(?s)(?:\s*//.*\n|\s*/\*.*?\*/\s*|\s*@\w+.*\n)*\s*data\s+class.*?(?=^\s*(?:data\s+class|\Z))"""
    val regex = Regex(pattern, RegexOption.MULTILINE)
    return regex.findAll(source).map { it.value.trim() }.toList()
}


---

ğŸ“Œ ä½¿ç”¨ç¤ºä¾‹

val sourceCode = """
// æ³¨é‡Š A
@Serializable
data class Person(val name: String, val age: Int)

/* æ³¨é‡Š B */
data class Book(val title: String, val author: String)

@Deprecated("æ—§ç±»")
data class OldUser(val id: Int)
"""

val classNames = extractDataClassNames(sourceCode)
println("ç±»ååˆ—è¡¨: $classNames")

val classBlocks = extractAllDataClasses(sourceCode)
classBlocks.forEachIndexed { index, block ->
    println("DataClass #$index:\n$block\n")
}


ğŸ‘‰ è¾“å‡ºç»“æœï¼š

â€¢ ç±»ååˆ—è¡¨ï¼š[Person, Book, OldUser]
â€¢ æ¯ä¸ª data class çš„å®Œæ•´ç‰‡æ®µï¼ˆåŒ…æ‹¬æ³¨é‡Šå’Œæ³¨è§£ï¼‰ã€‚


---

è¿™æ ·ä½ å°±èƒ½åŒæ—¶è·å– ç±»åæ¸…å• å’Œ å®Œæ•´ä»£ç ç‰‡æ®µï¼Œæ—¢æ–¹ä¾¿å¿«é€Ÿæµè§ˆï¼Œä¹Ÿèƒ½åšè¿›ä¸€æ­¥å¤„ç†ã€‚

è¦ä¸è¦æˆ‘å†å¸®ä½ å†™ä¸€ä¸ª ç»„åˆå‡½æ•°ï¼Œç›´æ¥è¿”å›ä¸€ä¸ª Map<String, String>ï¼Œé”®æ˜¯ç±»åï¼Œå€¼æ˜¯å®Œæ•´ç‰‡æ®µï¼Ÿè¿™æ ·ä½ å°±èƒ½ä¸€çœ¼çœ‹åˆ°ç±»åå’Œå¯¹åº”çš„ä»£ç ã€‚


===

å¥½çš„ ğŸ‘
è¿™é‡Œç»™ä½ ä¸€ä¸ªç»„åˆå‡½æ•°ï¼Œå¯ä»¥ç›´æ¥è¿”å›ä¸€ä¸ª Map<String, String>ï¼Œé”®æ˜¯ç±»åï¼Œå€¼æ˜¯å®Œæ•´çš„ data class ç‰‡æ®µï¼ˆåŒ…æ‹¬æ³¨é‡Šå’Œæ³¨è§£ï¼‰ã€‚è¿™æ ·ä½ å°±èƒ½ä¸€çœ¼çœ‹åˆ°ç±»åå’Œå¯¹åº”çš„ä»£ç ï¼š

fun extractDataClassMap(source: String): Map<String, String> {
    val pattern = """(?s)(?:\s*//.*\n|\s*/\*.*?\*/\s*|\s*@\w+.*\n)*\s*data\s+class\s+([A-Z]\w*).*?(?=^\s*(?:data\s+class|\Z))"""
    val regex = Regex(pattern, setOf(RegexOption.MULTILINE))

    val result = mutableMapOf<String, String>()
    regex.findAll(source).forEach { match ->
        val className = match.groupValues[1]
        result[className] = match.value.trim()
    }
    return result
}


---

ğŸ“Œ ä½¿ç”¨ç¤ºä¾‹

val sourceCode = """
// æ³¨é‡Š A
@Serializable
data class Person(val name: String, val age: Int)

/* æ³¨é‡Š B */
data class Book(val title: String, val author: String)

@Deprecated("æ—§ç±»")
data class OldUser(val id: Int)
"""

val classMap = extractDataClassMap(sourceCode)
classMap.forEach { (name, block) ->
    println("ç±»å: $name")
    println("ä»£ç ç‰‡æ®µ:\n$block\n")
}


ğŸ‘‰ è¾“å‡ºç»“æœï¼š

â€¢ Person â†’ åŒ…å«æ³¨é‡Šã€æ³¨è§£å’Œå®Œæ•´ data class
â€¢ Book â†’ åŒ…å«æ³¨é‡Šå’Œå®Œæ•´ data class
â€¢ OldUser â†’ åŒ…å«æ³¨è§£å’Œå®Œæ•´ data class


---

è¿™æ ·ä½ å°±èƒ½å¿«é€Ÿå®šä½ç±»åï¼ŒåŒæ—¶ä¿ç•™å®Œæ•´çš„ä¸Šä¸‹æ–‡ç‰‡æ®µï¼Œæ–¹ä¾¿åšè¿›ä¸€æ­¥åˆ†ææˆ–å¤„ç†ã€‚

è¦ä¸è¦æˆ‘å†å¸®ä½ åŠ ä¸€ä¸ª æ”¯æŒæŒ‰æ³¨è§£è¿‡æ»¤çš„ Map ç‰ˆæœ¬ï¼Œæ¯”å¦‚åªè¿”å›å¸¦ @Serializable çš„ç±»åå’Œä»£ç ï¼Ÿ


===


ä½ è¿™ä¸ªéœ€æ±‚å¯ä»¥åˆ†æˆä¸¤ä¸ªå±‚æ¬¡æ¥ç†è§£ï¼š

1. æŸ¥æ‰¾å¹¶å®šä½ data class â€”â€”æˆ‘ä»¬å‰é¢å·²ç»å†™äº†æ­£åˆ™å’Œå‡½æ•°ï¼Œå¯ä»¥æ‹¿åˆ°å®Œæ•´ç‰‡æ®µæˆ–ç±»åã€‚
2. åœ¨ data class å‰æ’å…¥ä¸€ä¸ªâ€œé€»è¾‘åˆ é™¤â€çš„æ³¨è§£ â€”â€”å³åœ¨æºç é‡Œæ’å…¥ä¸€è¡Œæ³¨è§£ï¼Œä½†åœ¨è¿è¡Œæ—¶å®ƒä¸ä¼šçœŸæ­£ç”Ÿæ•ˆæˆ–ä¼šè¢«å¿½ç•¥ã€‚


---

ğŸ› ï¸ æ’å…¥æ³¨è§£çš„æ–¹å¼

1. ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£ï¼ˆä½†ä¸åŠ å¤„ç†å™¨ï¼‰

@Target(AnnotationTarget.CLASS)
@Retention(AnnotationRetention.SOURCE) // åªä¿ç•™åœ¨æºç ï¼Œä¸è¿›å…¥å­—èŠ‚ç 
annotation class LogicalDeleted


â€¢ SOURCE ä¿ç•™ç­–ç•¥æ„å‘³ç€ç¼–è¯‘åä¸ä¼šè¿›å…¥ .class æ–‡ä»¶ï¼Œè¿è¡Œæ—¶å®Œå…¨æ— æ•ˆã€‚
â€¢ è¿™æ ·ä½ å¯ä»¥åœ¨ data class å‰æ’å…¥ @LogicalDeletedï¼Œä»£ç è¿˜åœ¨ï¼Œä½†è¿è¡Œæ—¶ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚


---

2. ä½¿ç”¨æ³¨é‡Šæ¨¡æ‹Ÿæ³¨è§£ï¼ˆå®Œå…¨æ— æ•ˆï¼‰

å¦‚æœä½ åªæ˜¯æƒ³â€œçœ‹èµ·æ¥åƒæ³¨è§£â€ï¼Œä½†å®Œå…¨ä¸å½±å“ç¼–è¯‘å’Œè¿è¡Œï¼Œå¯ä»¥ç›´æ¥æ’å…¥ä¸€è¡Œæ³¨é‡Šï¼š

//@LogicalDeleted
data class Person(val name: String, val age: Int)


è¿™ç§æ–¹å¼æœ€å½»åº•ï¼Œç¼–è¯‘å™¨ç›´æ¥å¿½ç•¥ã€‚

---

3. æ’å…¥çœŸå®æ³¨è§£ä½†è¿‡æ»¤æ‰

å¦‚æœä½ å¸Œæœ›æ³¨è§£å­˜åœ¨äºå­—èŠ‚ç ï¼Œä½†è¿è¡Œæ—¶é€»è¾‘ä¸Šå¿½ç•¥ï¼Œå¯ä»¥ï¼š

â€¢ å®šä¹‰ä¸€ä¸ªæ³¨è§£ @LogicalDeletedï¼Œä¿ç•™ç­–ç•¥ä¸º CLASS æˆ– RUNTIMEã€‚
â€¢ åœ¨è¿è¡Œæ—¶çš„åå°„æˆ–æ¡†æ¶é€»è¾‘é‡Œï¼Œä¸»åŠ¨è¿‡æ»¤æ‰è¿™ä¸ªæ³¨è§£ï¼Œä¸åšä»»ä½•å¤„ç†ã€‚


---

ğŸ” è‡ªåŠ¨æ’å…¥ç¤ºä¾‹å‡½æ•°

fun insertLogicalDeleteAnnotation(source: String, className: String): String {
    val regex = Regex("""(\s*data\s+class\s+$className)""")
    return source.replace(regex, "@LogicalDeleted\n$1")
}


ä½¿ç”¨ç¤ºä¾‹

val sourceCode = """
data class Person(val name: String, val age: Int)
"""

val updated = insertLogicalDeleteAnnotation(sourceCode, "Person")
println(updated)


ğŸ‘‰ è¾“å‡ºï¼š

@LogicalDeleted
data class Person(val name: String, val age: Int)


---

âš¡ æ€»ç»“

â€¢ å®Œå…¨æ— æ•ˆ â†’ ç”¨æ³¨é‡Š // @LogicalDeletedã€‚
â€¢ æºç å­˜åœ¨ä½†ç¼–è¯‘åæ¶ˆå¤± â†’ æ³¨è§£ä¿ç•™ç­–ç•¥ SOURCEã€‚
â€¢ ç¼–è¯‘å­˜åœ¨ä½†è¿è¡Œæ—¶å¿½ç•¥ â†’ æ³¨è§£ä¿ç•™ç­–ç•¥ CLASS æˆ– RUNTIMEï¼Œä½†åœ¨é€»è¾‘é‡Œè¿‡æ»¤æ‰ã€‚


---

è¦ä¸è¦æˆ‘å¸®ä½ å†™ä¸€ä¸ª æ‰¹é‡æ’å…¥å‡½æ•°ï¼Œå¯ä»¥å¯¹æå–åˆ°çš„æ‰€æœ‰ data class è‡ªåŠ¨åŠ ä¸Š @LogicalDeleted æ³¨è§£ï¼Ÿè¿™æ ·ä½ å°±èƒ½ä¸€æ¬¡æ€§å¤„ç†æ•´ä¸ªæ–‡ä»¶ã€‚



====

ä½ è¿™ä¸ªéœ€æ±‚å¯ä»¥åˆ†æˆä¸¤ä¸ªå±‚æ¬¡æ¥ç†è§£ï¼š

1. æŸ¥æ‰¾å¹¶å®šä½ data class â€”â€”æˆ‘ä»¬å‰é¢å·²ç»å†™äº†æ­£åˆ™å’Œå‡½æ•°ï¼Œå¯ä»¥æ‹¿åˆ°å®Œæ•´ç‰‡æ®µæˆ–ç±»åã€‚
2. åœ¨ data class å‰æ’å…¥ä¸€ä¸ªâ€œé€»è¾‘åˆ é™¤â€çš„æ³¨è§£ â€”â€”å³åœ¨æºç é‡Œæ’å…¥ä¸€è¡Œæ³¨è§£ï¼Œä½†åœ¨è¿è¡Œæ—¶å®ƒä¸ä¼šçœŸæ­£ç”Ÿæ•ˆæˆ–ä¼šè¢«å¿½ç•¥ã€‚


---

ğŸ› ï¸ æ’å…¥æ³¨è§£çš„æ–¹å¼

1. ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£ï¼ˆä½†ä¸åŠ å¤„ç†å™¨ï¼‰

@Target(AnnotationTarget.CLASS)
@Retention(AnnotationRetention.SOURCE) // åªä¿ç•™åœ¨æºç ï¼Œä¸è¿›å…¥å­—èŠ‚ç 
annotation class LogicalDeleted


â€¢ SOURCE ä¿ç•™ç­–ç•¥æ„å‘³ç€ç¼–è¯‘åä¸ä¼šè¿›å…¥ .class æ–‡ä»¶ï¼Œè¿è¡Œæ—¶å®Œå…¨æ— æ•ˆã€‚
â€¢ è¿™æ ·ä½ å¯ä»¥åœ¨ data class å‰æ’å…¥ @LogicalDeletedï¼Œä»£ç è¿˜åœ¨ï¼Œä½†è¿è¡Œæ—¶ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚


---

2. ä½¿ç”¨æ³¨é‡Šæ¨¡æ‹Ÿæ³¨è§£ï¼ˆå®Œå…¨æ— æ•ˆï¼‰

å¦‚æœä½ åªæ˜¯æƒ³â€œçœ‹èµ·æ¥åƒæ³¨è§£â€ï¼Œä½†å®Œå…¨ä¸å½±å“ç¼–è¯‘å’Œè¿è¡Œï¼Œå¯ä»¥ç›´æ¥æ’å…¥ä¸€è¡Œæ³¨é‡Šï¼š

//@LogicalDeleted
data class Person(val name: String, val age: Int)


è¿™ç§æ–¹å¼æœ€å½»åº•ï¼Œç¼–è¯‘å™¨ç›´æ¥å¿½ç•¥ã€‚

---

3. æ’å…¥çœŸå®æ³¨è§£ä½†è¿‡æ»¤æ‰

å¦‚æœä½ å¸Œæœ›æ³¨è§£å­˜åœ¨äºå­—èŠ‚ç ï¼Œä½†è¿è¡Œæ—¶é€»è¾‘ä¸Šå¿½ç•¥ï¼Œå¯ä»¥ï¼š

â€¢ å®šä¹‰ä¸€ä¸ªæ³¨è§£ @LogicalDeletedï¼Œä¿ç•™ç­–ç•¥ä¸º CLASS æˆ– RUNTIMEã€‚
â€¢ åœ¨è¿è¡Œæ—¶çš„åå°„æˆ–æ¡†æ¶é€»è¾‘é‡Œï¼Œä¸»åŠ¨è¿‡æ»¤æ‰è¿™ä¸ªæ³¨è§£ï¼Œä¸åšä»»ä½•å¤„ç†ã€‚


---

ğŸ” è‡ªåŠ¨æ’å…¥ç¤ºä¾‹å‡½æ•°

fun insertLogicalDeleteAnnotation(source: String, className: String): String {
    val regex = Regex("""(\s*data\s+class\s+$className)""")
    return source.replace(regex, "@LogicalDeleted\n$1")
}


ä½¿ç”¨ç¤ºä¾‹

val sourceCode = """
data class Person(val name: String, val age: Int)
"""

val updated = insertLogicalDeleteAnnotation(sourceCode, "Person")
println(updated)


ğŸ‘‰ è¾“å‡ºï¼š

@LogicalDeleted
data class Person(val name: String, val age: Int)


---

âš¡ æ€»ç»“

â€¢ å®Œå…¨æ— æ•ˆ â†’ ç”¨æ³¨é‡Š // @LogicalDeletedã€‚
â€¢ æºç å­˜åœ¨ä½†ç¼–è¯‘åæ¶ˆå¤± â†’ æ³¨è§£ä¿ç•™ç­–ç•¥ SOURCEã€‚
â€¢ ç¼–è¯‘å­˜åœ¨ä½†è¿è¡Œæ—¶å¿½ç•¥ â†’ æ³¨è§£ä¿ç•™ç­–ç•¥ CLASS æˆ– RUNTIMEï¼Œä½†åœ¨é€»è¾‘é‡Œè¿‡æ»¤æ‰ã€‚


---

è¦ä¸è¦æˆ‘å¸®ä½ å†™ä¸€ä¸ª æ‰¹é‡æ’å…¥å‡½æ•°ï¼Œå¯ä»¥å¯¹æå–åˆ°çš„æ‰€æœ‰ data class è‡ªåŠ¨åŠ ä¸Š @LogicalDeleted æ³¨è§£ï¼Ÿè¿™æ ·ä½ å°±èƒ½ä¸€æ¬¡æ€§å¤„ç†æ•´ä¸ªæ–‡ä»¶ã€‚


===

è¦åœ¨ Spring Boot é¡¹ç›®é‡Œæ‰«ææ‰€æœ‰ Kotlin æ–‡ä»¶å¹¶æ‰¾å‡ºåŒ…å« data class çš„æ–‡ä»¶ï¼Œå¯ä»¥ç”¨å‡ ç§æ–¹å¼æ¥å®ç°ã€‚ä¸‹é¢ç»™ä½ ä¸€ä¸ªå®ç”¨çš„æ–¹æ¡ˆï¼š

---

ğŸ› ï¸ æ–¹æ³•ä¸€ï¼šç”¨ Kotlin/Java ä»£ç æ‰«ææ–‡ä»¶ç³»ç»Ÿ

Spring Boot é¡¹ç›®æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª Maven/Gradle å·¥ç¨‹ï¼Œæºç é€šå¸¸åœ¨ src/main/kotlin ä¸‹ã€‚ä½ å¯ä»¥å†™ä¸€ä¸ªå°å·¥å…·ç±»æ¥é€’å½’æ‰«æï¼š

import java.io.File

fun findDataClassFiles(rootDir: String): List<String> {
    val result = mutableListOf<String>()
    val regex = Regex("""\bdata\s+class\b""")

    File(rootDir).walkTopDown()
        .filter { it.isFile && it.extension == "kt" }
        .forEach { file ->
            val content = file.readText()
            if (regex.containsMatchIn(content)) {
                result.add(file.absolutePath)
            }
        }
    return result
}

fun main() {
    val projectRoot = "src/main/kotlin" // Spring Boot é¡¹ç›®çš„ Kotlin æºç ç›®å½•
    val filesWithDataClass = findDataClassFiles(projectRoot)
    println("æ‰¾åˆ°çš„æ–‡ä»¶ï¼š")
    filesWithDataClass.forEach { println(it) }
}


ğŸ‘‰ è¾“å‡ºä¼šåˆ—å‡ºæ‰€æœ‰åŒ…å« data class çš„ Kotlin æ–‡ä»¶è·¯å¾„ã€‚

---

ğŸ› ï¸ æ–¹æ³•äºŒï¼šç”¨ Gradle Task è‡ªåŠ¨åŒ–

åœ¨ build.gradle.kts é‡ŒåŠ ä¸€ä¸ªè‡ªå®šä¹‰ä»»åŠ¡ï¼š

tasks.register("findDataClasses") {
    doLast {
        val regex = Regex("""\bdata\s+class\b""")
        val files = fileTree("src/main/kotlin") {
            include("**/*.kt")
        }
        files.forEach { file ->
            val text = file.readText()
            if (regex.containsMatchIn(text)) {
                println("åŒ…å« data class çš„æ–‡ä»¶: ${file.path}")
            }
        }
    }
}


è¿è¡Œï¼š

./gradlew findDataClasses


---

ğŸ› ï¸ æ–¹æ³•ä¸‰ï¼šç”¨ Shell/grep å¿«é€Ÿæ‰«æï¼ˆé€‚åˆ Linux/Macï¼‰

å¦‚æœåªæ˜¯å¿«é€ŸæŸ¥æ‰¾ï¼Œå¯ä»¥ç›´æ¥åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š

grep -rl "data class" src/main/kotlin


ğŸ‘‰ ä¼šè¿”å›æ‰€æœ‰åŒ…å« data class çš„æ–‡ä»¶è·¯å¾„ã€‚

---

âš¡ æ€»ç»“

â€¢ å¼€å‘ç¯å¢ƒå†…åµŒå·¥å…·ï¼šç”¨ Kotlin/Java å†™æ‰«æå™¨ï¼Œçµæ´»å¯æ‰©å±•ã€‚
â€¢ æ„å»ºå·¥å…·é›†æˆï¼šç”¨ Gradle Taskï¼Œæ–¹ä¾¿å›¢é˜Ÿå…±äº«ã€‚
â€¢ å‘½ä»¤è¡Œå¿«é€ŸæŸ¥æ‰¾ï¼šç”¨ grepï¼Œæœ€å¿«æ·ã€‚


---

è¦ä¸è¦æˆ‘å¸®ä½ æ‰©å±•ä¸€ä¸‹ï¼Œè®©æ‰«æç»“æœä¸ä»…è¿”å›æ–‡ä»¶è·¯å¾„ï¼Œè¿˜èƒ½æå–å‡º ç±»ååˆ—è¡¨ï¼ˆæ¯”å¦‚ Person, Bookï¼‰ï¼Œè¿™æ ·ä½ å°±èƒ½ç›´æ¥çŸ¥é“é¡¹ç›®é‡Œæœ‰å“ªäº› data classï¼Ÿ


===



