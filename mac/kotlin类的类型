Kotlin ä¸­çš„æ‰€æœ‰ç±»ç±»å‹

Kotlin çš„ç±»ç³»ç»Ÿéå¸¸ä¸°å¯Œï¼Œæˆ‘æ¥ä¸ºä½ å…¨é¢æ¢³ç†æ‰€æœ‰ç±»ç±»å‹ï¼š

ğŸ“Š åŸºç¡€ç±»ç±»å‹åˆ†ç±»

1. æŒ‰å£°æ˜æ–¹å¼åˆ†ç±»

ç±»å‹ å…³é”®å­— ç‰¹ç‚¹
æ™®é€šç±» class æ ‡å‡†ç±»å®šä¹‰
æ•°æ®ç±» data class è‡ªåŠ¨ç”ŸæˆtoString()ã€equals()ã€hashCode()ã€copy()
å¯†å°ç±» sealed class æœ‰é™åˆ¶çš„ç±»å±‚æ¬¡ç»“æ„
æšä¸¾ç±» enum class å›ºå®šæ•°é‡çš„å®ä¾‹
æŠ½è±¡ç±» abstract class ä¸èƒ½å®ä¾‹åŒ–ï¼Œç”¨äºç»§æ‰¿
æ¥å£ interface åªæœ‰å£°æ˜ï¼Œæ²¡æœ‰å®ç°
æ³¨è§£ç±» annotation class ç”¨äºå…ƒæ•°æ®
å¯¹è±¡å£°æ˜ object å•ä¾‹å¯¹è±¡
ä¼´ç”Ÿå¯¹è±¡ companion object ç±»çš„é™æ€æˆå‘˜å®¹å™¨
å†…éƒ¨ç±» inner class æŒæœ‰å¤–éƒ¨ç±»å¼•ç”¨
åµŒå¥—ç±» class ä¸æŒæœ‰å¤–éƒ¨ç±»å¼•ç”¨

ğŸ” è¯¦ç»†è§£ææ¯ç§ç±»å‹

1. æ™®é€šç±»ï¼ˆClassï¼‰

```kotlin
// åŸºæœ¬å½¢å¼
class Person(val name: String, var age: Int) {
    // ä¸»æ„é€ å‡½æ•°å‚æ•°è‡ªåŠ¨æˆä¸ºå±æ€§
    
    // æ¬¡æ„é€ å‡½æ•°
    constructor(name: String) : this(name, 0)
    
    // å±æ€§
    val isAdult: Boolean
        get() = age >= 18
    
    // æ–¹æ³•
    fun greet() = "Hello, I'm $name"
}

// ä½¿ç”¨
val person = Person("Alice", 25)
```

2. æ•°æ®ç±»ï¼ˆData Classï¼‰

```kotlin
// è‡ªåŠ¨ç”Ÿæˆ equals(), hashCode(), toString(), copy(), componentN()
data class User(
    val id: Int,
    val name: String,
    val email: String
)

// ä½¿ç”¨
val user1 = User(1, "Alice", "alice@email.com")
val user2 = user1.copy(name = "Bob")  // å¤åˆ¶å¹¶ä¿®æ”¹éƒ¨åˆ†å±æ€§
val (id, name, email) = user1  // è§£æ„å£°æ˜

// é™åˆ¶ï¼šä¸»æ„é€ å‡½æ•°å¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°
```

3. å¯†å°ç±»ï¼ˆSealed Classï¼‰

```kotlin
// å®šä¹‰æœ‰é™å¯èƒ½çš„å­ç±»é›†åˆ
sealed class Result<out T> {
    data class Success<T>(val data: T) : Result<T>()
    data class Error(val message: String) : Result<Nothing>()
    object Loading : Result<Nothing>()
}

// ä½¿ç”¨ï¼ˆwhenè¡¨è¾¾å¼ä¼šæ£€æŸ¥æ˜¯å¦è¦†ç›–æ‰€æœ‰æƒ…å†µï¼‰
fun handleResult(result: Result<String>) {
    when (result) {
        is Result.Success -> println("Success: ${result.data}")
        is Result.Error -> println("Error: ${result.message}")
        Result.Loading -> println("Loading...")
        // ä¸éœ€è¦ else åˆ†æ”¯ï¼
    }
}
```

4. æšä¸¾ç±»ï¼ˆEnum Classï¼‰

```kotlin
enum class Color(val rgb: Int) {
    RED(0xFF0000),
    GREEN(0x00FF00),
    BLUE(0x0000FF);  // æ³¨æ„åˆ†å·
    
    // å¯ä»¥æ·»åŠ æ–¹æ³•
    fun hexCode() = "#${rgb.toString(16).uppercase()}"
}

// ä½¿ç”¨
val color = Color.RED
println(color.hexCode())

// æšä¸¾å¸¸é‡å¯ä»¥å®ç°æ¥å£
enum class Direction : Runnable {
    NORTH {
        override fun run() { println("Going north") }
    },
    SOUTH {
        override fun run() { println("Going south") }
    }
}
```

5. æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰

```kotlin
abstract class Animal(val name: String) {
    // æŠ½è±¡å±æ€§
    abstract val sound: String
    
    // æŠ½è±¡æ–¹æ³•
    abstract fun makeSound()
    
    // å…·ä½“æ–¹æ³•
    fun introduce() {
        println("I'm $name")
    }
}

class Dog(name: String) : Animal(name) {
    override val sound = "Woof!"
    
    override fun makeSound() {
        println(sound)
    }
}
```

6. æ¥å£ï¼ˆInterfaceï¼‰

```kotlin
// Kotlinæ¥å£å¯ä»¥æœ‰å±æ€§ï¼ˆä½†ä¸èƒ½æœ‰å¹•åå­—æ®µï¼‰å’Œæ–¹æ³•å®ç°
interface Clickable {
    val isEnabled: Boolean  // æŠ½è±¡å±æ€§
    
    fun click()  // æŠ½è±¡æ–¹æ³•
    
    fun show() {  // å¸¦é»˜è®¤å®ç°çš„æ–¹æ³•
        println("Clickable element")
    }
}

interface Focusable {
    fun show() {
        println("Focusable element")
    }
}

class Button : Clickable, Focusable {
    override val isEnabled: Boolean = true
    
    override fun click() {
        println("Button clicked")
    }
    
    // è§£å†³å¤šä¸ªæ¥å£æ–¹æ³•å†²çª
    override fun show() {
        super<Clickable>.show()
        super<Focusable>.show()
        println("Button show")
    }
}
```

7. å¯¹è±¡å£°æ˜ï¼ˆObject Declarationï¼‰ - å•ä¾‹

```kotlin
// ç«‹å³åˆ›å»ºçš„å•ä¾‹
object Singleton {
    private var count = 0
    
    fun increment() = count++
    fun getCount() = count
    
    init {
        println("Singleton initialized")
    }
}

// ä½¿ç”¨
Singleton.increment()
println(Singleton.getCount())

// å®ç°æ¥å£
object HttpClient : Closeable {
    override fun close() {
        println("Closing connection")
    }
    
    fun get(url: String) = "Response from $url"
}
```

8. ä¼´ç”Ÿå¯¹è±¡ï¼ˆCompanion Objectï¼‰

```kotlin
class MyClass {
    companion object Factory {
        const val TAG = "MyClass"
        
        fun create(): MyClass = MyClass()
        
        // å¯ä»¥ç»§æ‰¿æ¥å£
        interface FactoryInterface
    }
}

// ä½¿ç”¨
val instance = MyClass.create()  // æˆ– MyClass.Factory.create()
println(MyClass.TAG)

// ä½œä¸ºå·¥å‚
class User private constructor(val name: String) {
    companion object {
        fun create(name: String): User {
            // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ åˆ›å»ºé€»è¾‘
            return User(name)
        }
    }
}
```

9. å¯¹è±¡è¡¨è¾¾å¼ï¼ˆObject Expressionï¼‰- åŒ¿åå¯¹è±¡

```kotlin
// ç±»ä¼¼Javaçš„åŒ¿åå†…éƒ¨ç±»
val listener = object : MouseAdapter() {
    override fun mouseClicked(e: MouseEvent) {
        println("Mouse clicked")
    }
    
    override fun mouseEntered(e: MouseEvent) {
        println("Mouse entered")
    }
    
    // å¯ä»¥æœ‰è‡ªå·±çš„æ–¹æ³•å’Œå±æ€§
    val timestamp = System.currentTimeMillis()
}

// ç®€å•çš„å¯¹è±¡è¡¨è¾¾å¼ï¼ˆä¸ç»§æ‰¿ä»»ä½•ç±»ï¼‰
val data = object {
    val x = 10
    val y = 20
    fun sum() = x + y
}
println(data.sum())
```

10. å†…éƒ¨ç±»ï¼ˆInner Classï¼‰

```kotlin
class Outer {
    private val outerValue = "Outer"
    
    // æ™®é€šåµŒå¥—ç±»ï¼ˆä¸æŒæœ‰å¤–éƒ¨ç±»å¼•ç”¨ï¼‰
    class Nested {
        fun getValue() = "Nested"
        // ä¸èƒ½è®¿é—® outerValue
    }
    
    // å†…éƒ¨ç±»ï¼ˆæŒæœ‰å¤–éƒ¨ç±»å¼•ç”¨ï¼‰
    inner class Inner {
        fun getValue() = "Inner: $outerValue"
    }
}

// ä½¿ç”¨
val nested = Outer.Nested()  // ä¸éœ€è¦å¤–éƒ¨ç±»å®ä¾‹
val inner = Outer().Inner()  // éœ€è¦å¤–éƒ¨ç±»å®ä¾‹
```

11. æ³¨è§£ç±»ï¼ˆAnnotation Classï¼‰

```kotlin
// å®šä¹‰æ³¨è§£
annotation class MyAnnotation(
    val priority: Int = 0,
    val tags: Array<String> = []
)

// ä½¿ç”¨
@MyAnnotation(priority = 1, tags = ["test", "kotlin"])
class TestClass {
    @MyAnnotation
    fun testMethod() {}
}

// å…ƒæ³¨è§£
@Target(AnnotationTarget.CLASS, AnnotationTarget.FUNCTION)
@Retention(AnnotationRetention.RUNTIME)
@Repeatable
@MustBeDocumented
annotation class ExperimentalFeature(val version: String)
```

ğŸ¯ ç‰¹æ®Šç±»ç±»å‹

1. å†…è”ç±»ï¼ˆInline Classï¼‰- å€¼ç±»

```kotlin
// Kotlin 1.5+ ä½¿ç”¨ value class
@JvmInline
value class Password(private val s: String) {
    // å¯ä»¥æœ‰æ–¹æ³•å’Œå±æ€§ï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªä¸»æ„é€ å‡½æ•°å‚æ•°
    init {
        require(s.length >= 8) { "Password too short" }
    }
    
    fun isValid(): Boolean = s.length >= 8
    
    // å†…è”ç±»åœ¨è¿è¡Œæ—¶å¯èƒ½è¢«æ›¿æ¢ä¸ºåº•å±‚ç±»å‹
}

// ä½¿ç”¨ï¼šæé«˜ç±»å‹å®‰å…¨æ€§ï¼Œæ— é¢å¤–å¼€é”€
val password = Password("secret123")
```

2. æ³›å‹ç±»ï¼ˆGeneric Classï¼‰

```kotlin
// åå˜ï¼ˆproducerï¼Œåªè¯»ï¼‰
class Box<out T>(private val value: T) {
    fun get(): T = value
    // ä¸èƒ½æœ‰æ¥å—Tä½œä¸ºå‚æ•°çš„æ–¹æ³•
}

// é€†å˜ï¼ˆconsumerï¼Œåªå†™ï¼‰
interface Consumer<in T> {
    fun consume(item: T)
}

// ä¸å˜
class Container<T>(var item: T)
```

3. æ ‡è®°æ¥å£ï¼ˆMarker Interfaceï¼‰

```kotlin
// æ²¡æœ‰ä»»ä½•æˆå‘˜ï¼Œä»…ä½œä¸ºæ ‡è®°
interface Serializable

class Document : Serializable {
    // ...
}

// ç±»å‹æ£€æŸ¥
fun save(obj: Any) {
    if (obj is Serializable) {
        // ä¿å­˜é€»è¾‘
    }
}
```

ğŸ”„ ç±»ä¹‹é—´çš„å…³ç³»

```kotlin
open class Base {
    open fun baseMethod() = "Base"
}

interface MyInterface {
    fun interfaceMethod(): String
}

// å•ç»§æ‰¿ï¼Œå¤šå®ç°
class Derived : Base(), MyInterface {
    override fun baseMethod() = "Derived"
    override fun interfaceMethod() = "Interface"
}

// å§”æ‰˜
interface Repository {
    fun getData(): String
}

class RepositoryImpl : Repository {
    override fun getData() = "Data"
}

// ç±»å§”æ‰˜ï¼ˆbyå…³é”®å­—ï¼‰
class EnhancedRepository(repo: Repository) : Repository by repo {
    // å¯ä»¥æ·»åŠ é¢å¤–åŠŸèƒ½
    fun enhancedGetData() = "Enhanced: ${getData()}"
}
```

ğŸ“ ç±»ä¿®é¥°ç¬¦æ€»ç»“

å¯è§æ€§ä¿®é¥°ç¬¦

Â· publicï¼ˆé»˜è®¤ï¼‰: åˆ°å¤„å¯è§
Â· internal: æ¨¡å—å†…å¯è§
Â· protected: å­ç±»å¯è§
Â· private: ç±»å†…å¯è§

å…¶ä»–ä¿®é¥°ç¬¦

Â· open: å¯è¢«ç»§æ‰¿ï¼ˆé»˜è®¤finalï¼‰
Â· abstract: æŠ½è±¡ç±»
Â· final: ç¦æ­¢è¢«è¦†ç›–ï¼ˆé»˜è®¤ï¼‰
Â· const: ç¼–è¯‘æ—¶å¸¸é‡
Â· lateinit: å»¶è¿Ÿåˆå§‹åŒ–
Â· override: è¦†ç›–çˆ¶ç±»æˆå‘˜

ğŸ® å®æˆ˜ç¤ºä¾‹ï¼šç»¼åˆä½¿ç”¨

```kotlin
// 1. å®šä¹‰å¯†å°ç±»ä½œä¸ºçŠ¶æ€
sealed class ViewState {
    object Loading : ViewState()
    data class Success(val data: List<String>) : ViewState()
    data class Error(val exception: Throwable) : ViewState()
}

// 2. æ•°æ®ç±»ä½œä¸ºå®ä½“
data class User(
    val id: Int,
    val name: String,
    val email: String
)

// 3. æ¥å£å®šä¹‰å¥‘çº¦
interface Repository {
    fun getUsers(): ViewState
}

// 4. å•ä¾‹å¯¹è±¡ä½œä¸ºå®ç°
object UserRepository : Repository {
    private val users = listOf(
        User(1, "Alice", "alice@email.com"),
        User(2, "Bob", "bob@email.com")
    )
    
    override fun getUsers(): ViewState {
        return ViewState.Success(users)
    }
}

// 5. ä½¿ç”¨ä¼´ç”Ÿå¯¹è±¡
class UserViewModel {
    companion object {
        const val TAG = "UserViewModel"
    }
    
    fun loadUsers() = UserRepository.getUsers()
}
```

ğŸ’¡ é€‰æ‹©æŒ‡å—

éœ€æ±‚ æ¨èç±»å‹ åŸå› 
æ•°æ®ä¼ è¾“å¯¹è±¡ æ•°æ®ç±» è‡ªåŠ¨ç”Ÿæˆå¸¸ç”¨æ–¹æ³•
çŠ¶æ€ç®¡ç† å¯†å°ç±» ä¿è¯æ‰€æœ‰æƒ…å†µè¢«å¤„ç†
å·¥å…·/é…ç½® å¯¹è±¡å£°æ˜ å•ä¾‹ï¼Œå…¨å±€è®¿é—®
å·¥å‚æ¨¡å¼ ä¼´ç”Ÿå¯¹è±¡ æ›¿ä»£é™æ€å·¥å‚æ–¹æ³•
å›è°ƒ/ç›‘å¬å™¨ å¯¹è±¡è¡¨è¾¾å¼ åŒ¿åå®ç°
æœ‰é™é€‰é¡¹ æšä¸¾ç±» ç±»å‹å®‰å…¨
åŸºç±»/æ¨¡æ¿ æŠ½è±¡ç±» å¼ºåˆ¶å­ç±»å®ç°
å¤šé‡ç»§æ‰¿ æ¥å£ Kotlinæ”¯æŒå¤šæ¥å£
ç±»å‹å®‰å…¨åŒ…è£… å†…è”ç±» é›¶å¼€é”€åŒ…è£…

ä½ æ˜¯åœ¨å­¦ä¹ ç‰¹å®šåœºæ™¯ï¼ˆAndroidã€åç«¯ã€ç®—æ³•ï¼‰å—ï¼Ÿ ä¸åŒåœºæ™¯ä¸‹è¿™äº›ç±»ç±»å‹çš„ä½¿ç”¨ä¾§é‡ä¸åŒï¼Œæˆ‘å¯ä»¥æä¾›æ›´é’ˆå¯¹æ€§çš„å»ºè®®ï¼